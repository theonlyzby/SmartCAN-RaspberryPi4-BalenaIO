<!-- BEGIN: main -->
<html>
  <head>
    <title>SmartCAN - La Domotique, Smart</title>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000"/>	
    <meta name="viewport" content="initial-scale=1.0">
    <meta http-equiv="content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
	<!-- meta name=viewport content="width=device-width, initial-scale=1" -->
	<!-- Phone layout? meta name=viewport content="width=800" -->
	
	<!-- WebApp Declarations -->
	<link rel="manifest" href="/smartcan/www/manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes"> 
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	
	<!-- Icons -->
	<!-- All Browser ico=32*32, png=72*72 -->
	<link rel="icon" href="./images/icons/favicon.ico" type="image/x-icon"/>
	<link rel="icon" href="./images/icons/favicon.png" type="image/x-icon"/>
	<!-- Android -->
	<link href="./images/icons/icon-196x196.png"                          rel="shortcut icon" sizes="196x196">
	<!-- iOS -->
	<link href="./images/icons/apple-touch-icon.png"                      rel="apple-touch-icon" />
	<link href="./images/icons/apple-touch-icon-57x57.png"                rel="apple-touch-icon" sizes="57x57" />
	<link href="./images/icons/apple-touch-icon-72x72.png"                rel="apple-touch-icon" sizes="72x72" />
	<link href="./images/icons/apple-touch-icon-76x76.png"                rel="apple-touch-icon" sizes="76x76" />
	<link href="./images/icons/apple-touch-icon-114x114.png"              rel="apple-touch-icon" sizes="114x114" />
	<link href="./images/icons/apple-touch-icon-114x114-precomposed.png"  rel="apple-touch-icon-precomposed" sizes="114x114" />
	<link href="./images/icons/apple-touch-icon-120x120.png"              rel="apple-touch-icon" sizes="120x120" />
	<link href="./images/icons/apple-touch-icon-144x144.png"              rel="apple-touch-icon" sizes="144x144" />
	<link href="./images/icons/apple-touch-icon-152x152.png"              rel="apple-touch-icon" sizes="152x152" />
	<link href="./images/icons/apple-touch-icon-180x180.png"              rel="apple-touch-icon" sizes="180x180" />
	<link href="./images/icons/icon-hires.png"                            rel="icon" sizes="192x192" />
	<link href="./images/icons/icon-normal.png"                           rel="icon" sizes="128x128" />
	
	<!-- Load Images -->
	<!-- iPhone -->
	<link rel="apple-touch-startup-image"       media="(device-width: 320px)"	href="./images/icons/apple-touch-startup-image-320x460.png">
	<!-- iPhone (Retina) -->
	<link rel="apple-touch-startup-image"		media="(device-width: 320px) and (-webkit-device-pixel-ratio: 2)" href="./images/icons/apple-touch-startup-image-640x920.png">
	<!-- iPad (portrait) -->
	<link rel="apple-touch-startup-image"       media="(device-width: 768px) and (orientation: portrait)" href="./images/icons/apple-touch-startup-image-768x1004.png">
	<!-- iPad (landscape) -->
	<link rel="apple-touch-startup-image"       media="(device-width: 768px) and (orientation: landscape)" href="./images/icons/apple-touch-startup-image-748x1024.png">
	<!-- iPad (Retina, portrait) -->
	<link rel="apple-touch-startup-image"       media="(device-width: 768px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)"
      href="./images/icons/apple-touch-startup-image-1536x2008.png">
	<!-- iPad (Retina, landscape) -->
	<link rel="apple-touch-startup-image"       media="(device-width: 768px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)"
      href="./images/icons/apple-touch-startup-image-1496x2048.png">  
	
	
	<link rel="stylesheet" href="./css/tablet/structure.css" type="text/css" />
    <script type="text/javascript" src="./lib/jquery-1.4.4.min.js"></script>
    <link rel="stylesheet" type="text/css" href="./lib/weather/jquery.jdigiclock.css" />
    <script type="text/javascript" src="./lib/weather/lib/jquery.jdigiclock.js"></script>
	<!--  <link rel="stylesheet" type="text/css" href="./css/tablet/roboto.all.css" /> -->


<!-- BEGIN: css_specific_file -->
    <link rel="stylesheet" href="{CSU}" type="text/css" />
    <!--  <link rel="stylesheet" href="./css/tablet/{PAGE}.css" type="text/css" />  -->
<!-- END: css_specific_file -->

    {XAJAX}

{FILE {JAVASCRIPT}}

    <script type="text/javascript">

      $(document).ready(function() {
	    if (window.location.protocol != 'https:') {
		  //alert('NOT https');
		  location.href = location.href.replace("http://", "https://");
		}
        var iframe = document.createElement("iframe");
        iframe.src = "/smartcan/www/lib/listen.html";
        iframe.style.display = "none";
        document.body.appendChild(iframe);
      });

      function reception(data) {
        tab = data.split(';');
        if ( tab[0] == 'message' ) {
          $('#message').text(tab[1]);
        }
        else {
          if ( window.receptionmodule ) {
            receptionmodule(tab[0], tab[1]);
          }
        }
      }

      function go(contenu) {
        var theme=document.getElementById("usedtheme").value;
        url = '?page=' + contenu;
        if (theme!='') { url = url + '&theme=' + theme; }
        setTimeout("window.location.replace(url)", 100);
      }

      function traitement() {
        $('#traitement').css('display', 'block');
      }
	  function fin_traitement() {
        $('#traitement').css('display', 'none');
      }

    </script>
	
	<script type="text/javascript">
	  idleTime = 0; 
	  
	  $(document).ready(function() {
	  
	  if ('serviceWorker' in navigator) {
		window.addEventListener('load', function() {
			navigator.serviceWorker.register('./service-worker.js').then(function(registration) {
				// Registration was successful
				console.log('PWA: ServiceWorker registration successful with scope: ', registration.scope);
			}, function(err) {
				// registration failed :(
				console.log('PWA: ServiceWorker registration failed: ', err);
			});
		});
	  }
	  window.addEventListener('online', function(e) {
    // Resync data with server.
    console.log("PWA: You are online");
    //Page.hideOfflineWarning();
    //Arrivals.loadData();
}, false);

window.addEventListener('offline', function(e) {
    // Queue up events for server.
    console.log("PWA: You are offline");
    <!-- //Page.showOfflineWarning(); -->
}, false);

// Check if the user is connected.
if (navigator.onLine) {
    //Arrivals.loadData();
} else {
    // Show offline message
    Page.showOfflineWarning();
}

// Set Knockout view model bindings.
//ko.applyBindings(Page.vm);
	  
		var idleInterval = setInterval("timerIncrement()", 100000); // 100 seconde
		$(this).mousemove(function(e) {
		  idleTime = 0;
	    });
		$(this).mousedown(function(e) {
		  idleTime = 0;
	    });
	    $(this).keypress(function(e) {
		  idleTime = 0;
	    });
	  });

	  function timerIncrement() {
		idleTime = idleTime + 1;
		if ((idleTime >= 3) && (document.getElementById("div_sess").getAttribute('data-value'))) {
		  // After 5 Minutes time out (3*100 seconds) ... logout, if session active
		  //alert('Cookie='+document.cookie);
		  //alert('Sess Div='+document.getElementById("div_sess").getAttribute('data-value'));
		  //window.location = '?logout=1';
		}
	  }
	  
	</script>
  </head>

  <body>
    <div style="display: none;" id="div_sess" name="div_sess" data-value="{DIV_SESS}"></div>
    <div class="conteneur" style="z-index: 1;"><input type="hidden" id="usedtheme" value="{USED_THEME}"/>
      <div class="entete">
        <p>{TITRE}</p>
        <div id="message">
        Pret...
        </div>
      </div>
      <div class="corps">
        <div class="corps_gauche">
{FILE {content}}
        </div>
        <div class="corps_droite">
          <table cellpadding="0" cellspacing="0">
            <tr>
              <td class="column1">
                <img src="./images/fr/lights.png" onClick="go('lights');" />
              </td>
              <td class="column2">&nbsp;</td>
              <td class="column3">
                <img src="./images/fr/heater.png" onClick="go('thermostat');" />
              </td>
			  <td class="column2">&nbsp;</td>
			  <td class="column1">
                <img src="./images/fr/surveillance.png" onClick="go('surveillance');" />
              </td>
            </tr>
            <tr>
              <td class="column1">
                <img src="./images/fr/vibes.png" onClick="go('vibes');" />
              </td>
              <td class="column2">&nbsp;</td>
              <td class="column3">
                <img src="./images/fr/weather.png" onClick="go('weather');" />
              </td>
              <td class="column2">&nbsp;</td>
              <td class="column3">
                <img src="./images/fr/misc.png" onClick="go('misc');" />
              </td>
            </tr>
          </table>
          <span id="traitement" style="font-size: 12px; color: red; font-weight: bold; display: none;">Traitement en cours...</span>
        </div>
      </div>
    </div>
  </body>
</html>
<!-- END: main -->
